<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}FinanceFlow - Banking AI Management System 2026{% endblock %}</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                        },
                        secondary: {
                            500: '#8b5cf6',
                            600: '#7c3aed',
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.3s ease-in',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    
    <!-- Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    
    <style>
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
        }
        
        .glass-effect {
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .glass-card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.2);
            transition: all 0.3s ease;
        }
        
        .glass-card:hover {
            background: rgba(30, 41, 59, 0.95);
            border-color: rgba(148, 163, 184, 0.4);
            transform: translateY(-2px);
        }
        
        .sidebar {
            transition: transform 0.3s ease;
        }
        
        .sidebar.mobile-hidden {
            transform: translateX(-100%);
        }
        
        .nav-link {
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }
        
        .nav-link:hover,
        .nav-link.active {
            background: rgba(14, 165, 233, 0.1);
            border-left-color: #0ea5e9;
            padding-left: calc(1rem + 4px);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #0ea5e9 0%, #8b5cf6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .stat-card {
            background: linear-gradient(135deg, rgba(14, 165, 233, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .progress-ring {
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
        
        .badge-success {
            background: rgba(34, 197, 94, 0.2);
            color: #86efac;
            border: 1px solid rgba(34, 197, 94, 0.5);
        }
        
        .badge-warning {
            background: rgba(251, 146, 60, 0.2);
            color: #fed7aa;
            border: 1px solid rgba(251, 146, 60, 0.5);
        }
        
        .badge-danger {
            background: rgba(239, 68, 68, 0.2);
            color: #fca5a5;
            border: 1px solid rgba(239, 68, 68, 0.5);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(14, 165, 233, 0.3);
        }
        
        .input-glass {
            background: rgba(15, 23, 42, 0.5);
            border: 1px solid rgba(148, 163, 184, 0.3);
            color: #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .input-glass:focus {
            background: rgba(15, 23, 42, 0.7);
            border-color: rgba(14, 165, 233, 0.6);
            box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
        }
        
        .input-glass::placeholder {
            color: #94a3b8;
        }
    </style>
    
    {% block extra_css %}{% endblock %}
</head>

<body class="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900">
    
    <!-- Sidebar Navigation -->
    <aside class="sidebar fixed left-0 top-0 w-64 h-screen glass-effect border-r border-slate-700 z-40 lg:translate-x-0 md:w-56 sm:w-48">
        <!-- Logo -->
        <div class="px-6 py-6 border-b border-slate-700">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-gradient-to-br from-green-500 to-blue-600 rounded-lg flex items-center justify-center">
                    <i class="fas fa-university text-white text-lg"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold gradient-text">FinanceFlow</h1>
                    <p class="text-xs text-slate-400">AI Banking 2026</p>
                </div>
            </div>
        </div>
        
        <!-- Navigation Menu -->
        <nav class="px-4 py-6 space-y-2 overflow-y-auto" style="height: calc(100vh - 140px);">
            
            <!-- Main -->
            <p class="px-4 py-2 text-xs font-semibold text-slate-500 uppercase tracking-wider">Main</p>
            
            <a href="/" class="nav-link block px-4 py-3 rounded-lg text-slate-200 hover:text-white">
                <i class="fas fa-home w-5 mr-3"></i>Dashboard
            </a>
            
            <!-- Banking Services -->
            <p class="px-4 py-2 mt-4 text-xs font-semibold text-slate-500 uppercase tracking-wider">Banking</p>
            
            <a href="/accounts/dashboard" class="nav-link block px-4 py-3 rounded-lg text-slate-200 hover:text-white">
                <i class="fas fa-credit-card w-5 mr-3"></i>My Accounts
            </a>
            
            <a href="/savings/dashboard" class="nav-link block px-4 py-3 rounded-lg text-slate-200 hover:text-white">
                <i class="fas fa-piggy-bank w-5 mr-3"></i>Savings
            </a>
            
            <a href="/credit/dashboard" class="nav-link block px-4 py-3 rounded-lg text-slate-200 hover:text-white">
                <i class="fas fa-credit-card w-5 mr-3"></i>Credit
            </a>
            
            <a href="/products/" class="nav-link block px-4 py-3 rounded-lg text-slate-200 hover:text-white">
                <i class="fas fa-box w-5 mr-3"></i>Products
            </a>
            
            <a href="/transactions/" class="nav-link block px-4 py-3 rounded-lg text-slate-200 hover:text-white">
                <i class="fas fa-exchange-alt w-5 mr-3"></i>Transactions
            </a>
            
            <a href="/planning/" class="nav-link block px-4 py-3 rounded-lg text-slate-200 hover:text-white">
                <i class="fas fa-chart-pie w-5 mr-3"></i>Financial Planning
            </a>
            
            <a href="/investments/" class="nav-link block px-4 py-3 rounded-lg text-slate-200 hover:text-white">
                <i class="fas fa-coins w-5 mr-3"></i>Investments
            </a>
            
            <a href="/advisor/" class="nav-link block px-4 py-3 rounded-lg text-slate-200 hover:text-white">
                <i class="fas fa-robot w-5 mr-3"></i>AI Advisor
            </a>
            
            <!-- Admin -->
            <p class="px-4 py-2 mt-4 text-xs font-semibold text-slate-500 uppercase tracking-wider">Admin</p>
            
            <a href="/admin/dashboard" class="nav-link block px-4 py-3 rounded-lg text-slate-200 hover:text-white">
                <i class="fas fa-chart-line w-5 mr-3"></i>Analytics
            </a>
            
            <a href="/admin/settings" class="nav-link block px-4 py-3 rounded-lg text-slate-200 hover:text-white">
                <i class="fas fa-cog w-5 mr-3"></i>Settings
            </a>
            
        </nav>
        {% if current_user.is_authenticated %}
        <div class="px-4 py-4 border-t border-slate-700">
            <form method="POST" action="{{ url_for('auth.logout') }}" class="w-full">
                <button type="submit" class="nav-link block w-full text-left px-4 py-3 rounded-lg text-slate-200 hover:text-white">
                    <i class="fas fa-sign-out-alt w-5 mr-3"></i>Logout
                </button>
            </form>
        </div>
        {% endif %}
        
        <!-- User Profile widget removed per user request -->
    </aside>
    
    <!-- Mobile Menu Button -->
    <button id="mobileMenuBtn" class="fixed left-4 top-4 z-50 lg:hidden bg-slate-700 text-white p-2 rounded-lg hover:bg-slate-600 transition">
        <i class="fas fa-bars text-lg"></i>
    </button>
    
    <!-- Main Content -->
    <main class="ml-64 lg:ml-64 md:ml-56 sm:ml-0 min-h-screen">
        
        <!-- Header -->
        <header class="glass-effect border-b border-slate-700 sticky top-0 z-30">
            <div class="px-6 py-4 flex items-center justify-between">
                <div>
                    <h2 class="text-2xl font-bold text-white">{% block page_title %}Welcome Back{% endblock %}</h2>
                    <p class="text-sm text-slate-400 mt-1">{% block page_subtitle %}{% endblock %}</p>
                </div>
                
                <div class="flex items-center gap-4">
                    <!-- User Profile Dropdown (Real) -->
                    <div class="relative">
                        <button id="profileBtn" class="flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-slate-700 transition">
                            <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-sm font-bold">
                                {% if current_user.is_authenticated %}
                                    {{ current_user.username[:2].upper() }}
                                {% else %}
                                    U
                                {% endif %}
                            </div>
                            <i class="fas fa-chevron-down text-slate-400 text-xs"></i>
                        </button>
                        
                        <!-- Dropdown Menu -->
                        <div id="profileDropdown" class="profile-dropdown absolute right-0 mt-2 w-48 glass-effect rounded-lg shadow-xl hidden transition-all duration-200 z-50">
                            {% if current_user.is_authenticated %}
                                <a href="{{ url_for('auth.profile') }}" class="block px-4 py-2 text-slate-300 hover:text-white hover:bg-slate-700 rounded-t-lg transition">
                                    <i class="fas fa-user w-4 mr-2" style="color: #fbbf24;"></i>Profile
                                </a>
                                <a href="{{ url_for('auth.profile') }}" class="block px-4 py-2 text-slate-300 hover:text-white hover:bg-slate-700 transition">
                                    <i class="fas fa-cog w-4 mr-2" style="color: #fbbf24;"></i>Settings
                                </a>
                                <hr class="border-slate-600 my-1">
                                <form method="POST" action="{{ url_for('auth.logout') }}" class="w-full">
                                    <button type="submit" class="w-full text-left block px-4 py-2 text-slate-300 hover:text-red-400 hover:bg-slate-700 rounded-b-lg transition">
                                        <i class="fas fa-sign-out-alt w-4 mr-2" style="color: #fca5a5;"></i>Logout
                                    </button>
                                </form>
                            {% else %}
                                <a href="{{ url_for('auth.login') }}" class="block px-4 py-2 text-slate-300 hover:text-white hover:bg-slate-700 rounded-t-lg transition">
                                    <i class="fas fa-sign-in-alt w-4 mr-2" style="color: #fbbf24;"></i>Login
                                </a>
                                <a href="{{ url_for('auth.register') }}" class="block px-4 py-2 text-slate-300 hover:text-white hover:bg-slate-700 rounded-b-lg transition">
                                    <i class="fas fa-user-plus w-4 mr-2" style="color: #fbbf24;"></i>Register
                                </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Page Content -->
        <div class="p-6 md:p-8 lg:p-10">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        {% set color = 'bg-blue-600' %}
                        {% if category == 'success' %}{% set color = 'bg-green-600' %}{% elif category in ['danger','error'] %}{% set color = 'bg-red-600' %}{% elif category == 'warning' %}{% set color = 'bg-yellow-600' %}{% else %}{% set color = 'bg-blue-600' %}{% endif %}
                        <div class="mb-4 p-4 rounded-lg glass-effect border border-slate-600 text-slate-200 animate-fade-in">
                            <div class="flex items-start gap-3">
                                <span class="w-8 h-8 rounded-full {{ color }} flex items-center justify-center text-white">
                                    <i class="fas fa-{{ 'check' if category=='success' else 'exclamation' if category in ['danger','error'] else 'info' }}-circle"></i>
                                </span>
                                <div class="flex-1">
                                    <p class="font-medium">{{ message }}</p>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            {% block content %}{% endblock %}
        </div>
        
        <!-- Footer -->
        <footer class="glass-effect border-t border-slate-700 mt-12">
            <div class="px-6 md:px-8 lg:px-10 py-8">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
                    <div>
                        <h4 class="font-semibold text-white mb-4 flex items-center gap-2">
                            <i class="fas fa-landmark text-blue-500"></i>
                            FinanceFlow
                        </h4>
                        <p class="text-sm text-slate-400">Secure banking platform with AI financial management.</p>
                    </div>
                    
                    <div>
                        <h5 class="text-sm font-semibold text-white mb-4">Services</h5>
                        <ul class="space-y-2 text-sm text-slate-400">
                            <li><a href="/accounts/dashboard" class="hover:text-slate-200 transition">Account Management</a></li>
                            <li><a href="/products/" class="hover:text-slate-200 transition">Banking Products</a></li>
                            <li><a href="/investments/" class="hover:text-slate-200 transition">Investments</a></li>
                            <li><a href="/advisor/" class="hover:text-slate-200 transition">AI Advisor</a></li>
                        </ul>
                    </div>
                    
                    <div>
                        <h5 class="text-sm font-semibold text-white mb-4">Company</h5>
                        <ul class="space-y-2 text-sm text-slate-400">
                            <li><a href="#" class="hover:text-slate-200 transition">About</a></li>
                            <li><a href="#" class="hover:text-slate-200 transition">Blog</a></li>
                            <li><a href="#" class="hover:text-slate-200 transition">Contact</a></li>
                            <li><a href="#" class="hover:text-slate-200 transition">Support</a></li>
                        </ul>
                    </div>
                    
                    <div>
                        <h5 class="text-sm font-semibold text-white mb-4">Legal</h5>
                        <ul class="space-y-2 text-sm text-slate-400">
                            <li><a href="#" class="hover:text-slate-200 transition">Privacy</a></li>
                            <li><a href="#" class="hover:text-slate-200 transition">Terms</a></li>
                            <li><a href="#" class="hover:text-slate-200 transition">Security</a></li>
                            <li><a href="#" class="hover:text-slate-200 transition">Cookies</a></li>
                        </ul>
                    </div>
                </div>
                
                <div class="border-t border-slate-700 pt-6 flex items-center justify-between">
                    <p class="text-sm text-slate-400">&copy; 2026 FinanceFlow. All rights reserved. Banking AI Platform.</p>
                    <div class="flex gap-4">
                        <a href="#" class="text-slate-400 hover:text-blue-500 transition">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="#" class="text-slate-400 hover:text-blue-500 transition">
                            <i class="fab fa-linkedin"></i>
                        </a>
                        <a href="#" class="text-slate-400 hover:text-blue-500 transition">
                            <i class="fab fa-github"></i>
                        </a>
                    </div>
                </div>
            </div>
        </footer>
        
    </main>
    
    <script>
        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const sidebar = document.querySelector('.sidebar');
        
        mobileMenuBtn?.addEventListener('click', () => {
            sidebar.classList.toggle('mobile-hidden');
        });
        
        // Close menu when clicking on links (mobile)
        const navLinks = document.querySelectorAll('.nav-link');
        navLinks.forEach(link => {
            link.addEventListener('click', () => {
                if (window.innerWidth < 1024) {
                    sidebar.classList.add('mobile-hidden');
                }
            });
        });
        
        // Set active nav link
        const currentPath = window.location.pathname;
        navLinks.forEach(link => {
            if (link.getAttribute('href') === currentPath) {
                link.classList.add('active');
            }
        });
        
        // Profile dropdown click handler
        const profileBtn = document.getElementById('profileBtn');
        const profileDropdown = document.getElementById('profileDropdown');
        if (profileBtn && profileDropdown) {
            profileBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                profileDropdown.classList.toggle('hidden');
            });
            
            // Close dropdown when clicking outside
            document.addEventListener('click', () => {
                profileDropdown.classList.add('hidden');
            });
        }
        
        // Toast notification function
        function showNotification(message, type = 'info', duration = 3000) {
            const toast = document.createElement('div');
            const bgColor = {
                'success': 'bg-green-600',
                'error': 'bg-red-600',
                'warning': 'bg-yellow-600',
                'info': 'bg-blue-600'
            }[type] || 'bg-blue-600';
            
            toast.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg animate-fade-in z-50`;
            toast.innerHTML = `<i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation' : 'info'}-circle mr-2"></i>${message}`;
            
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), duration);
        }
        
        // Responsive sidebar on resize
        window.addEventListener('resize', () => {
            if (window.innerWidth >= 1024) {
                sidebar.classList.remove('mobile-hidden');
            }
        });
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    {% block extra_js %}{% endblock %}
</body>
</html>
